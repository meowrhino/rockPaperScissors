<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>rockPaperScissors!</title>
</head>

<body>

    <script>

        /*we have to make the computer choose a random choice between rock, paper and scissors
        and for that we want to get an integer from 1 to 3 (1, 2 or 3)*/

        function getRandomInt(max) {
            return Math.floor(Math.random() * max + 1);
        };

        /*and then we convert that number to a valid option for the game*/

        function getComputerChoice() {
            let number = getRandomInt(3);
            let choice;

            switch (number) {
                case 1:
                    choice = "rock";
                    break

                case 2:
                    choice = "paper";
                    break

                case 3:
                    choice = "scissors";
                    break
            }
            return choice
        }

        /*we prepare the variables we'll need for the round*/

        let computerChoice;

        /*players input and choice are different bc we can only take rock as an answer
        so we will convert ROCK and roCk into rock later*/
        let playerInput;
        let playerChoice;

        let veredict;



        /*we also have to be able to store the results of each game to declare the best of 5*/

        let computerVictories;
        let playerVictories;
        let ties;

        function playRound() {

            /*we create an input for the player to introduce their choice
            and convert the input into a simpler string
            so that ROCK, Rock and rock are all converted to "rock"*/
            /*it would be cool if this was a function we could call 
            instead of doing this conversion here AND in the if statement
            but this is a message for the future manu*/

            playerInput = prompt("choose your weapon of choice");
            playerChoice = playerInput.toLowerCase();
            console.log(`player choice is ${playerChoice}`);

            /*we have to check its a valid input*/

            if (playerChoice != 'rock' && playerChoice != 'paper' && playerChoice != 'scissors') {
                console.log('verification started');
                while (playerChoice !== 'rock' && playerChoice !== 'paper' && playerChoice !== 'scissors') {
                    playerInput = prompt("the input you submitted is not a valid one please choose between rock, paper or scissors");
                    playerChoice = playerInput.toLowerCase();
                }
                console.log('verification was succesful');
                console.log('new player input is ' + playerChoice);
            }


            /*we also call the function to get the computer's choice*/
            computerChoice = getComputerChoice();
            console.log(`computer choice is ${computerChoice}`);

            /*and we evaluate the results*/

            if (playerChoice === computerChoice) {
                veredict = "tie";

            } else if (playerChoice !== computerChoice) {

                switch (playerChoice) {
                    case "scissors":
                        if (computerChoice == "paper") {
                            veredict = "player wins";
                        } else if (computerChoice == "rock") {
                            veredict = "computer wins";
                        }
                        break

                    case "paper":
                        if (computerChoice == "rock") {
                            veredict = "player wins";
                        } else if (computerChoice == "scissors") {
                            veredict = "computer wins";
                        }
                        break

                    case "rock":
                        if (computerChoice == "scissors") {
                            veredict = "player wins";
                        } else if (computerChoice == "paper") {
                            veredict = "computer wins";
                        }
                        break

                }
            }

            /*and we load the results into the variables we created*/

            if (veredict === "computer wins") {
                computerVictories++;
            } else if (veredict === "player wins") {
                playerVictories++;
            } else {
                ties++;
            }

            console.log(veredict);
            console.log(" ");
        }

        function game() {
            /*in each game we restart these values so that we "start fresh" each time*/

            computerVictories = 0;
            playerVictories = 0;
            ties = 0;

            for (i = 1; i < 6; i++) {
                console.log("round " + i + ":")
                playRound();
            }

            /*and IF after those 5 rounds they're tied this will code will trigger:*/

            while (playerVictories === computerVictories) {
                console.log("player and computer are tied we must repeat the final round!!!")
                console.log(" ");
                console.log("la revancha:")
                playRound();
            }

            /*finally we print the results*/

            if (computerVictories > playerVictories) {
                veredictFive = "computer wins best of five";
            } else if (playerVictories > computerVictories) {
                veredictFive = "player wins best of five";
            } else {
                veredictFive = "something happened";
            }

            console.log('Veredict is ' + veredictFive);
            console.log('Computer won ' + computerVictories + ' number of times');
            console.log('Player won ' + playerVictories + ' number of times');

        }

        game();


    </script>

</body>

</html>